# **유효성 검사**
>[상품관리애플리케이션](https://github.com/dbalsk/TIL/blob/main/SpringBoot/%EC%83%81%ED%92%88%EA%B4%80%EB%A6%AC%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98.md) 실습에 유효성 검사 및 전역 예외 핸들러를 적용함으로써 **유효성 검사**와 **예외처리전략**에 대해 학습해보자
  
## 유효성 검사     
**✔ 유효성 검사의 위치**    
- **도메인 지식**의 유효성 검사 -> **도메인 객체**    
ex) 상품이름의 길이는 1~100
- **도메인 지식과 무관한** 데이터 그 자체의 유효 유무 검사 -> **DTO (컨트롤러)**    
ex) 상품이름 필드 자체가 JSON에 포함안된 경우, null로 보낸 경우  
   
**✔ 잘못된 유효성 검사**  
1. getter를 사용하여 **도메인 지식을 외부로 유출** -> 중복된 코드 생성, 도메인객체의 응집도 떨어짐 
2. **예외를 던지지 않고** null과 같은 불필요한 값을 반환 

**✔ 유효성 검사 방법**   
1. **생성자**   
-> 생성자에서 특정 필드의 유효성을 검사하고 실패 시 예외를 던지고 **인스턴스가 애초에 생성되지 않도록** 함.
2. **setter**
3. **Bean Validation**  
->JSR-303이라는 스펙을 사용하여 유효성 검사하는 행위 (JSR-380을 주로 사용하나 실습에서는 JSR-303 사용)

>현재 ModelMapper를 사용 중이기에 생성자에서 검사하는 방법은 사용할 수 없어 Bean Validation을 사용하여 유효성 검사 진행

</br>

**✔ 도메인 객체에 대한 유효성 검사**    
1. Bean Validation 사용을 위해 **'spring-boot-starter-validation' 의존성** 추가 
2. 도메인 객체 필드에 이노테이션 추가 ex) **@Size, @Max, @Min**  
-> 이로써 도메인 지식은 내부에 머물고 서비스에서 유효성 검사 진행 명령 가능
3. **ValidationService 클래스** 생성 / **checkValid 메소드** 선언
```ruby
    @Service //빈으로 등록
    @Validated //valid 붙은 메소드 매개변수 유효성 검사
    public class ValidationService {
        //다른 도메인 객체가 추가되어도 동작할 수 있도록 제네릭 타입으로 선언 
        public <T> void checkValid(@Valid T validationTarget){
            //인자를 담아 호출만으로도 유효성 검증이 이뤄지기에 비워둠.
        }
    }
```
4. 서비스 코드에서 ValidationService를 **의존성 주입**해주고 add 메소드(상품 추가 기능)에서 **checkValid 메소드를 호출**하여 유효성 검사

</br>

## 참고자료  
[이것이백엔드개발이다](https://product.kyobobook.co.kr/detail/S000211834105)
