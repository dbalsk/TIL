# **데이터베이스**
> 데이터베이스의 사용이유 및 사용방법, 도커를 통해 데이터베이스의 기초적인 내용을 학습해보자 
## 데이터베이스 사용이유
>데이터를 저장하는 여러 방법이 가지고 있는 **문제점**을 살펴보며 데이터베이스를 사용하는 이유를 학습해보자. 
    
**❗ 리스트로 메모리에 데이터를 저장하는 방법**   
애플리케이션 내에서 컬렉션(리스트)로 메모리에 데이터를 저장하는 경우 발생하는 문제점
- 데이터의 **휘발성** -> 재시작 or 오류로 종료되면 모든 데이터 날아감
- 애플리케이션 간 **데이터 공유 불가** -> 데이터를 내부에 가지고 있어 애플리케이션 간 공유 어려움 (API 통신만으로는 트랜잭션 처리, 데이터 무결성과 같은 제약 지키기 어려움.)

>+**트랜잭션(Transaction)**  
데이터베이스에서 데이터의 상태를 변경하는 작업을 **모두 실행되거나 모두 실행되지 않는 상태**(**원자성**)가 되도록 하며 독립적으로 처리(**격리성**)하는 프로세스. 작업 전후에 데이터의 일관성과 무결성을 보장(**일관성**)하며 성공할 경우 영구적으로 반영(**지속성**)  
(모든 동작 성공 시 트랜잭션 커밋 / 특정 동작 실패 시 트랜잭션 시작되기 전 상태로 롤백)   
**ACID**(원자성/일관성/격리성/지속성)의 성질을 만족해야함.  

>+**무결성**  
데이터베이스에서 데이터의 **정확성**과 **일관성**을 유지하는 특성.  
ex) 데이터베이스에 트랜잭션 없음 -> 연산이 실패했는데 그대로 전송 -> 데이터 무결성이 깨짐.  
(즉, 데이터베이스의 필수적 기능 요소이고 트랜잭션으로 무결성을 유지해야함.)

**❗ 데이터를 파일로 저장하는 방법**   
각각의 애플리케이션 서버에서 데이터를 파일로 저장하는 경우 발생하는 문제점 (휘발성 문제는 해결)

- 애플리케이션 간 **데이터 공유 불가**

**❗ 데이터베이스를 서버로 구현하여 데이터를 저장하는 방법**   
데이터베이스와 같은 역할을 하는 웹 애플리케이션 서버를 만들어 데이터를 저장하는 경우 발생하는 문제점 (휘발성/데이터공유 문제는 해결)
- 데이터베이스의 핵심기능 (CRUD, 커넥션, 트랜잭션 등)을 **직접 구현**해야함
- **성능 감소** (데이터베이스는 한번 읽은 데이터를 캐시하여 보관, 추후 읽을 데이터를 미리 읽어 와서 보관하여 성능 좋음)

**✔ 데이터베이스의 장점**
- **영속성** 있게 데이터 관리
    - 애플리케이션 종료 시에도 데이터 보존
    - 데이터베이스 종료 시에도 메모리 아닌 디스크에 저장하여 데이터 보존 
- **데이터 공유** 가능
    - 모든 애플리케이션이 데이터베이스에 데이터 저장 및 조회 
- **트랜잭션** 지원 / 데이터 **무결성** 

## 데이터베이스 사용방법
**✔ 환경에 따른 데이터베이스 사용방법**
- 개발환경 - 개발자의 **PC안에서** 데이터베이스 설치 및 실행
- 운영환경 - 별도의 **서버에** 웹 애플리케이션 / 데이터베이스 각각 설치 

**✔ 로컬 환경에서 데이터베이스 실행**   
PC에서 데이터베이스 실행 방법
- 데이터베이스 직접 설치하여 실행 
- **도커(Docker)** 사용 

## 데이터베이스 다루기
> 도커를 통해 데이터베이스 실행 및 스키마/테이블을 생성 및 다뤄보자 

1. **도커 데스크톱** 설치 (도커 + ui 제공)
2. 도커로 **데이터베이스 실행** (MySQL 데이터베이스 실행)
```
//명령 프롬프트(cmd)에 명령어 입력    
docker run --name some-mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=sample -d mysql:8.0.29 --character-set-server=utf8m4 --collation-server=utf8mb4_general_ci
```
    1. docker run //도커로 실행
    2. --name some-mysql //이름 설정 (여러 데이터베이스 구분을 위해)
    3. -p 3306:3306 //도커 내부의 3306포트와 외부의 3306 포트 연결
    4. -e MYSQL_ROOT_PASSWORD=sample //관리자 계정 비밀번호 설정
    5. -d mysql:8.0.29 //실행시킬 도커의 종류 
    6. --character-set-server=utf8m4 --collation-server=utf8mb4_general_ci //MySQL에서 사용될 인코딩 방식 

-> 위 명령어로 데이터베이스 사용 준비 완료 (**도커 컨테이너가 실행 중**)      
>+**도커 컨테이너**  
>도커 이미지(컨테이너 실행을 위한 파일)를 기반으로 동작하는 실행환경   
>위 경우는 mysql 8.0.29 버전이 담겨있는 도커 이미지를 다운로드하고 실행하여 도커 컨테이너 생성 및 실행. 

</br>

3. **MySQL 도커 컨테이너**로 직접 접속   
-> Open in terminal     
4. **MySQL 데이터베이스 내부**로 접속   
-> mysql -u root -p 및 비밀번호 입력  
5. **데이터베이스(스키마) 생성**
    - 스키마 확인 -> SHOW DATABASES;
    - 스키마 추가 -> CREATE SCHEMA 스키마명;
    - 스키마 사용 상태로 -> USE 스키마명;


>+데이터베이스는 상황에 따라 두가지로 구분 가능   
>- **데이터베이스 인스턴스(Database Instance)**  
    -> 데이터베이스 프로세스 자체
>- **데이터베이스 스키마 (Database Schema)**  
    -> 데이터베이스 프로세스 내에 직접 추가해 줘야 하는 요소   
><img src="https://github.com/dbalsk/TIL/blob/main/pic/pc-%ED%85%8C%EC%9D%B4%EB%B8%94%EA%B9%8C%EC%A7%80%20%EA%B4%80%EA%B3%84%EB%8F%84.png" width="180" height="300"/>

6. **테이블 생성**  
     실질적으로 데이터 저장되는 공간    
    - 테이블 확인 -> SHOW TABLES;
    - 테이블 추가 -> CREATE TABLE 테이블명(칼럼);
7. 테이블에 **데이터 추가 및 조회** 
    - 데이터 추가 -> INSERT INTO 테이블명 (칼럼) VALUES (값);
    - 데이터 조회 -> SELECT 조회할칼럼명 FROM 테이블명;

## 참고자료  
[이것이백엔드개발이다](https://product.kyobobook.co.kr/detail/S000211834105)
